{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar FriendsList = function (_Component) {\n  _inherits(FriendsList, _Component);\n\n  var _super = _createSuper(FriendsList);\n\n  function FriendsList(props) {\n    var _this;\n\n    _classCallCheck(this, FriendsList);\n\n    _this = _super.call(this, props);\n\n    _this.loadFriendRequests = function _callee() {\n      var value;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('@session_token'));\n\n            case 2:\n              value = _context.sent;\n              return _context.abrupt(\"return\", fetch('http://localhost:3333/api/1.0.0/friendrequests', {\n                headers: {\n                  'X-Authorization': value\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  return response.json();\n                } else if (response.status === 401) {\n                  alert('You need to log in');\n\n                  _this.props.navigation.navigate('Login');\n                } else {\n                  throw 'Something went wrong';\n                }\n              }).then(function (responseJson) {\n                console.log(responseJson);\n\n                _this.setState({\n                  isLoading: false,\n                  friendRequestData: responseJson\n                });\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.acceptFriendRequest = function _callee2(requestingUserID) {\n      var value;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _this.state.isLoading = true;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('@session_token'));\n\n            case 3:\n              value = _context2.sent;\n              return _context2.abrupt(\"return\", fetch('http://localhost:3333/api/1.0.0/friendrequests/' + requestingUserID, {\n                method: 'post',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'X-Authorization': value\n                }\n              }).then(function (response) {\n                _this.loadFriendRequests();\n\n                if (response.status === 201) {\n                  return response.json();\n                } else if (response.status === 400) {\n                  throw 'Failed validation';\n                } else {\n                  throw 'Something went wrong';\n                }\n              }).then(function (responseJson) {\n                console.log(responseJson);\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.declineFriendReques = function _callee3(requestingUserID) {\n      var value;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _this.state.isLoading = true;\n              console.log('Friend Request for user ' + requestingUserID + ' Declined');\n              _context3.next = 4;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem('@session_token'));\n\n            case 4:\n              value = _context3.sent;\n              return _context3.abrupt(\"return\", fetch('http://localhost:3333/api/1.0.0/friendrequests/' + requestingUserID, {\n                method: 'delete',\n                headers: {\n                  'Content-Type': 'application/json',\n                  'X-Authorization': value\n                }\n              }).then(function (response) {\n                _this.loadFriendRequests();\n\n                if (response.status === 201) {\n                  return response.json();\n                } else if (response.status === 400) {\n                  throw 'Failed validation';\n                } else {\n                  throw 'Something went wrong';\n                }\n              }).then(function (responseJson) {\n                _this.loadFriendRequests();\n\n                _this.setState({\n                  isLoading: false\n                });\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      isLoading: true,\n      friendRequestData: []\n    };\n    return _this;\n  }\n\n  _createClass(FriendsList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadFriendRequests();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      if (this.state.isLoading) {\n        return _jsx(View, {\n          style: {\n            flex: 1,\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center'\n          },\n          children: _jsx(Text, {\n            children: \"Loading\"\n          })\n        });\n      } else {\n        return _jsxs(ScrollView, {\n          children: [_jsx(FlatList, {\n            data: this.state.friendRequestData,\n            renderItem: function renderItem(_ref) {\n              var item = _ref.item,\n                  index = _ref.index;\n              return _jsxs(View, {\n                children: [_jsxs(Text, {\n                  children: [item.first_name, \" \", item.last_name]\n                }), _jsx(Button, {\n                  onPress: function onPress() {\n                    return _this2.acceptFriendRequest(item.user_id);\n                  },\n                  title: \"Accept\"\n                }), _jsx(Button, {\n                  onPress: function onPress() {\n                    return _this2.declineFriendReques(item.user_id);\n                  },\n                  title: \"Decline\"\n                })]\n              });\n            }\n          }), _jsx(Button, {\n            title: \"Go Back\",\n            onPress: function onPress() {\n              return _this2.props.navigation.goBack();\n            }\n          }), _jsx(Button, {\n            title: \"Load Page\",\n            onPress: function onPress() {\n              return _this2.loadFriendRequests();\n            }\n          })]\n        });\n      }\n    }\n  }]);\n\n  return FriendsList;\n}(Component);\n\nvar styles = StyleSheet.create({});\nexport default FriendsList;","map":{"version":3,"sources":["C:/Users/louis/Desktop/Spacebook/screens/FriendsList.js"],"names":["React","Component","ScrollView","AsyncStorage","FriendsList","props","loadFriendRequests","getItem","value","fetch","headers","then","response","status","json","alert","navigation","navigate","responseJson","console","log","setState","isLoading","friendRequestData","catch","error","acceptFriendRequest","requestingUserID","state","method","declineFriendReques","flex","flexDirection","justifyContent","alignItems","item","index","first_name","last_name","user_id","goBack","styles","StyleSheet","create"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport {\n  Text,\n  TextInput,\n  View,\n  Button,\n  StyleSheet,\n  FlatList,\n  Alert,\n} from 'react-native';\nimport { ScrollView } from 'react-native-gesture-handler';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\n\nclass FriendsList extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      friendRequestData: [],\n    };\n  }\n\n  componentDidMount() {\n    this.loadFriendRequests();\n  }\n\n  loadFriendRequests = async () => {\n    //Gets user session token\n    const value = await AsyncStorage.getItem('@session_token');\n\n    return fetch('http://localhost:3333/api/1.0.0/friendrequests', {\n      headers: {\n        'X-Authorization': value,\n      },\n    })\n      .then((response) => {\n        if (response.status === 200) {\n          return response.json();\n        } else if (response.status === 401) {\n          alert('You need to log in');\n          this.props.navigation.navigate('Login');\n        } else {\n          throw 'Something went wrong';\n        }\n      })\n      .then((responseJson) => {\n        console.log(responseJson);\n        this.setState({\n          isLoading: false,\n          friendRequestData: responseJson,\n        });\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n    console.log('Reloading friend request');\n  };\n\n  acceptFriendRequest = async (requestingUserID) => {\n    this.state.isLoading = true;\n\n    //Gets user session token\n    const value = await AsyncStorage.getItem('@session_token');\n\n    return fetch(\n      'http://localhost:3333/api/1.0.0/friendrequests/' + requestingUserID,\n      {\n        method: 'post',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Authorization': value,\n        },\n      }\n    )\n      .then((response) => {\n        //Reloads friend request list\n        this.loadFriendRequests();\n        if (response.status === 201) {\n          return response.json();\n        } else if (response.status === 400) {\n          throw 'Failed validation';\n        } else {\n          throw 'Something went wrong';\n        }\n      })\n      .then((responseJson) => {\n        console.log(responseJson);\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  declineFriendReques = async (requestingUserID) => {\n    this.state.isLoading = true;\n\n    console.log('Friend Request for user ' + requestingUserID + ' Declined');\n\n    //Gets user session token\n    const value = await AsyncStorage.getItem('@session_token');\n\n    return fetch(\n      'http://localhost:3333/api/1.0.0/friendrequests/' + requestingUserID,\n      {\n        method: 'delete',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Authorization': value,\n        },\n      }\n    )\n      .then((response) => {\n        //Reloads friend request list\n        this.loadFriendRequests();\n        if (response.status === 201) {\n          return response.json();\n        } else if (response.status === 400) {\n          throw 'Failed validation';\n        } else {\n          throw 'Something went wrong';\n        }\n      })\n      .then((responseJson) => {\n        this.loadFriendRequests();\n        this.setState({\n          isLoading: false,\n        });\n      })\n      .catch((error) => {\n        console.log(error);\n      });\n  };\n\n  render() {\n    if (this.state.isLoading) {\n      return (\n        <View\n          style={{\n            flex: 1,\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center',\n          }}\n        >\n          <Text>Loading</Text>\n        </View>\n      );\n    } else {\n      return (\n        <ScrollView>\n          <FlatList\n            data={this.state.friendRequestData}\n            renderItem={({ item, index }) => (\n              <View>\n                <Text>\n                  {item.first_name} {item.last_name}\n                </Text>\n                <Button\n                  onPress={() => this.acceptFriendRequest(item.user_id)}\n                  title=\"Accept\"\n                />\n                <Button\n                  onPress={() => this.declineFriendReques(item.user_id)}\n                  title=\"Decline\"\n                />\n              </View>\n            )}\n          />\n\n          <Button\n            title=\"Go Back\"\n            onPress={() => this.props.navigation.goBack()}\n          />\n          <Button title=\"Load Page\" onPress={() => this.loadFriendRequests()} />\n        </ScrollView>\n      );\n    }\n  }\n}\n\nconst styles = StyleSheet.create({});\n\nexport default FriendsList;\n"]},"metadata":{},"sourceType":"module"}