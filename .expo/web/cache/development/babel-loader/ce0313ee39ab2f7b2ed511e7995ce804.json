{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { Component } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar storeData = function storeData(login, post, post_id) {\n  var jsonLogin, jsonPost, jsonPostID;\n  return _regeneratorRuntime.async(function storeData$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          _context.prev = 0;\n          jsonLogin = JSON.stringify(login);\n          jsonPost = JSON.stringify(post);\n          jsonPostID = JSON.stringify(post_id);\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@spacebook_details', jsonLogin));\n\n        case 6:\n          _context.next = 8;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@post', jsonPost));\n\n        case 8:\n          _context.next = 10;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem('@post_id', jsonPostID));\n\n        case 10:\n          _context.next = 15;\n          break;\n\n        case 12:\n          _context.prev = 12;\n          _context.t0 = _context[\"catch\"](0);\n          console.error(_context.t0);\n\n        case 15:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, [[0, 12]], Promise);\n};\n\nvar getData = function getData(done) {\n  var jsonValue, data;\n  return _regeneratorRuntime.async(function getData$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          _context2.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem('@spacebook_details'));\n\n        case 3:\n          jsonValue = _context2.sent;\n          data = JSON.parse(jsonValue);\n          return _context2.abrupt(\"return\", done(data));\n\n        case 8:\n          _context2.prev = 8;\n          _context2.t0 = _context2[\"catch\"](0);\n          console.error(_context2.t0);\n\n        case 11:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[0, 8]], Promise);\n};\n\nvar HomeScreen = function (_Component) {\n  _inherits(HomeScreen, _Component);\n\n  var _super = _createSuper(HomeScreen);\n\n  function HomeScreen(props) {\n    var _this;\n\n    _classCallCheck(this, HomeScreen);\n\n    _this = _super.call(this, props);\n    _this.refresh = _this.props.navigation.addListener('focus', function () {\n      getData(function (data) {\n        _this.setState({\n          login_info: data,\n          isLoading: true,\n          feed: {}\n        });\n\n        _this.getFeed();\n      });\n    });\n\n    _this.getFeed = function () {\n      console.log('Getting feed...');\n      return fetch('http://localhost:3333/api/1.0.0/user/' + _this.state.login_info.id + '/post', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Authorization': _this.state.login_info.token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        console.log(responseJson);\n\n        _this.setState({\n          isLoading: false,\n          feed: responseJson\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.deletePost = function (post_id) {\n      console.log('Deleting post...');\n      return fetch('http://localhost:3333/api/1.0.0/user/' + _this.state.login_info.id + '/post/' + post_id, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Authorization': _this.state.login_info.token\n        }\n      }).then(function (response) {\n        return response.json();\n      }).then(function (responseJson) {\n        console.log(responseJson);\n\n        _this.setState({\n          isLoading: false\n        });\n      }).catch(function (error) {\n        console.log(error);\n      });\n    };\n\n    _this.editPost = function () {\n      storeData(_this.state.login_info, _this.state.to_be_edited, _this.state.to_be_edited.post_id);\n\n      _this.props.navigation.navigate('Edit Post');\n    };\n\n    _this.viewPost = function () {\n      storeData(_this.state.login_info, _this.state.to_be_edited, _this.state.to_be_edited.post_id);\n\n      _this.props.navigation.navigate('Post');\n    };\n\n    _this.state = {\n      login_info: {},\n      isLoading: true,\n      to_be_edited: {},\n      feed: {}\n    };\n    return _this;\n  }\n\n  _createClass(HomeScreen, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      getData(function (data) {\n        _this2.setState({\n          login_info: data,\n          isLoading: true,\n          feed: {}\n        });\n\n        _this2.getFeed();\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.isLoading) {\n        return _jsx(View, {\n          children: _jsx(Text, {\n            children: \"Loading...\"\n          })\n        });\n      } else {\n        console.log('here', this.state);\n        return _jsx(ScrollView, {\n          contentContainerStyle: styles.scrollView,\n          children: _jsxs(View, {\n            children: [_jsx(Button, {\n              style: styles.buttonStyle,\n              title: \"Add post to my wall\",\n              onPress: function onPress() {\n                return _this3.props.navigation.navigate('New Post');\n              }\n            }), _jsx(View, {\n              style: styles.flexContainer,\n              children: _jsx(FlatList, {\n                data: this.state.feed,\n                renderItem: function renderItem(_ref) {\n                  var item = _ref.item;\n                  return _jsxs(View, {\n                    style: styles.itemContainer,\n                    children: [_jsxs(Text, {\n                      children: [item.author.first_name, \" \", item.author.last_name, \":\"]\n                    }), _jsx(Text, {\n                      children: item.text\n                    }), _jsxs(Text, {\n                      children: [\"Likes: \", item.numLikes]\n                    }), _jsxs(View, {\n                      style: styles.buttonContainer,\n                      children: [_jsx(Button, {\n                        style: styles.buttonStyle,\n                        title: \"View\",\n                        onPress: function onPress() {\n                          _this3.setState({\n                            to_be_edited: item\n                          }, function () {\n                            _this3.viewPost();\n                          });\n                        }\n                      }), item.author.user_id == _this3.state.login_info.id ? _jsx(Button, {\n                        style: styles.buttonStyle,\n                        title: \"Edit\",\n                        onPress: function onPress() {\n                          _this3.setState({\n                            to_be_edited: item,\n                            isLoading: true\n                          }, function () {\n                            _this3.editPost();\n                          });\n                        }\n                      }) : null, item.author.user_id == _this3.state.login_info.id ? _jsx(Button, {\n                        style: styles.buttonStyle,\n                        title: \"Delete\",\n                        onPress: function onPress() {\n                          _this3.deletePost(item.post_id);\n\n                          _this3.setState({\n                            feed: {},\n                            isLoading: true\n                          }, function () {\n                            _this3.getFeed();\n                          });\n                        }\n                      }) : null]\n                    })]\n                  });\n                },\n                keyExtractor: function keyExtractor(item, index) {\n                  return item.post_id;\n                }\n              })\n            })]\n          })\n        });\n      }\n    }\n  }]);\n\n  return HomeScreen;\n}(Component);\n\nvar styles = StyleSheet.create({\n  flexContainer: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-start'\n  },\n  outerContainer: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  itemContainer: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-start',\n    marginBottom: 20\n  },\n  buttonStyle: {\n    width: 50,\n    height: 50,\n    alignItems: 'center'\n  },\n  buttonContainer: {\n    flex: 1,\n    flexDirection: 'row',\n    justifyContent: 'flex-start',\n    alignItems: 'flex-start'\n  },\n  headerStyle: {\n    flex: 1,\n    flexDirection: 'column',\n    justifyContent: 'space-around',\n    alignItems: 'flex-start'\n  },\n  scrollView: {\n    flex: 1,\n    height: '100%',\n    width: '100%',\n    margin: 20,\n    alignSelf: 'center'\n  }\n});\nexport default HomeScreen;","map":{"version":3,"sources":["C:/Users/louis/Desktop/Spacebook/screens/HomeScreen.js"],"names":["React","Component","AsyncStorage","storeData","login","post","post_id","jsonLogin","JSON","stringify","jsonPost","jsonPostID","setItem","console","error","getData","done","getItem","jsonValue","data","parse","HomeScreen","props","refresh","navigation","addListener","setState","login_info","isLoading","feed","getFeed","log","fetch","state","id","method","headers","token","then","response","json","responseJson","catch","deletePost","editPost","to_be_edited","navigate","viewPost","styles","scrollView","buttonStyle","flexContainer","item","itemContainer","author","first_name","last_name","text","numLikes","buttonContainer","user_id","index","StyleSheet","create","flex","flexDirection","justifyContent","alignItems","outerContainer","marginBottom","width","height","headerStyle","margin","alignSelf"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport {\r\n  Text,\r\n  Image,\r\n  TextInput,\r\n  View,\r\n  Button,\r\n  StyleSheet,\r\n  Alert,\r\n  ScrollView,\r\n  FlatList,\r\n} from 'react-native';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst storeData = async (login, post, post_id) => {\r\n  try {\r\n    const jsonLogin = JSON.stringify(login);\r\n    const jsonPost = JSON.stringify(post);\r\n    const jsonPostID = JSON.stringify(post_id);\r\n    await AsyncStorage.setItem('@spacebook_details', jsonLogin);\r\n    await AsyncStorage.setItem('@post', jsonPost);\r\n    await AsyncStorage.setItem('@post_id', jsonPostID);\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nconst getData = async (done) => {\r\n  try {\r\n    const jsonValue = await AsyncStorage.getItem('@spacebook_details');\r\n    const data = JSON.parse(jsonValue);\r\n    return done(data);\r\n  } catch (e) {\r\n    console.error(e);\r\n  }\r\n};\r\n\r\nclass HomeScreen extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      login_info: {},\r\n      isLoading: true,\r\n      to_be_edited: {},\r\n      feed: {},\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    getData((data) => {\r\n      this.setState({\r\n        login_info: data,\r\n        isLoading: true,\r\n        feed: {},\r\n      });\r\n\r\n      this.getFeed();\r\n    });\r\n  }\r\n\r\n  refresh = this.props.navigation.addListener('focus', () => {\r\n    getData((data) => {\r\n      this.setState({\r\n        login_info: data,\r\n        isLoading: true,\r\n        feed: {},\r\n      });\r\n\r\n      this.getFeed();\r\n    });\r\n  });\r\n\r\n  getFeed = () => {\r\n    console.log('Getting feed...');\r\n    return fetch(\r\n      'http://localhost:3333/api/1.0.0/user/' +\r\n        this.state.login_info.id +\r\n        '/post',\r\n      {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Authorization': this.state.login_info.token,\r\n        },\r\n      }\r\n    )\r\n      .then((response) => response.json())\r\n      .then((responseJson) => {\r\n        console.log(responseJson);\r\n        this.setState({\r\n          isLoading: false,\r\n          feed: responseJson,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  deletePost = (post_id) => {\r\n    console.log('Deleting post...');\r\n    return fetch(\r\n      'http://localhost:3333/api/1.0.0/user/' +\r\n        this.state.login_info.id +\r\n        '/post/' +\r\n        post_id,\r\n      {\r\n        method: 'DELETE',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'X-Authorization': this.state.login_info.token,\r\n        },\r\n      }\r\n    )\r\n      .then((response) => response.json())\r\n      .then((responseJson) => {\r\n        console.log(responseJson);\r\n        this.setState({\r\n          isLoading: false,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  editPost = () => {\r\n    storeData(\r\n      this.state.login_info,\r\n      this.state.to_be_edited,\r\n      this.state.to_be_edited.post_id\r\n    );\r\n    this.props.navigation.navigate('Edit Post');\r\n  };\r\n\r\n  viewPost = () => {\r\n    storeData(\r\n      this.state.login_info,\r\n      this.state.to_be_edited,\r\n      this.state.to_be_edited.post_id\r\n    );\r\n    this.props.navigation.navigate('Post');\r\n  };\r\n\r\n  render() {\r\n    if (this.state.isLoading) {\r\n      return (\r\n        <View>\r\n          <Text>Loading...</Text>\r\n        </View>\r\n      );\r\n    } else {\r\n      console.log('here', this.state);\r\n      return (\r\n        <ScrollView contentContainerStyle={styles.scrollView}>\r\n          <View>\r\n            <Button\r\n              style={styles.buttonStyle}\r\n              title=\"Add post to my wall\"\r\n              onPress={() => this.props.navigation.navigate('New Post')}\r\n            />\r\n\r\n            <View style={styles.flexContainer}>\r\n              <FlatList\r\n                data={this.state.feed}\r\n                renderItem={({ item }) => (\r\n                  <View style={styles.itemContainer}>\r\n                    <Text>\r\n                      {item.author.first_name} {item.author.last_name}:\r\n                    </Text>\r\n                    <Text>{item.text}</Text>\r\n                    <Text>Likes: {item.numLikes}</Text>\r\n\r\n                    <View style={styles.buttonContainer}>\r\n                      <Button\r\n                        style={styles.buttonStyle}\r\n                        title=\"View\"\r\n                        onPress={() => {\r\n                          this.setState({ to_be_edited: item }, () => {\r\n                            this.viewPost();\r\n                          });\r\n                        }}\r\n                      />\r\n\r\n                      {item.author.user_id == this.state.login_info.id ? (\r\n                        <Button\r\n                          style={styles.buttonStyle}\r\n                          title=\"Edit\"\r\n                          onPress={() => {\r\n                            this.setState(\r\n                              { to_be_edited: item, isLoading: true },\r\n                              () => {\r\n                                this.editPost();\r\n                              }\r\n                            );\r\n                          }}\r\n                        />\r\n                      ) : null}\r\n\r\n                      {item.author.user_id == this.state.login_info.id ? (\r\n                        <Button\r\n                          style={styles.buttonStyle}\r\n                          title=\"Delete\"\r\n                          onPress={() => {\r\n                            this.deletePost(item.post_id);\r\n                            this.setState({ feed: {}, isLoading: true }, () => {\r\n                              this.getFeed();\r\n                            });\r\n                          }}\r\n                        />\r\n                      ) : null}\r\n                    </View>\r\n                  </View>\r\n                )}\r\n                keyExtractor={(item, index) => item.post_id}\r\n              />\r\n            </View>\r\n          </View>\r\n        </ScrollView>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  flexContainer: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'flex-start',\r\n    alignItems: 'flex-start',\r\n  },\r\n\r\n  outerContainer: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n\r\n  itemContainer: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'flex-start',\r\n    alignItems: 'flex-start',\r\n    marginBottom: 20,\r\n  },\r\n\r\n  buttonStyle: {\r\n    width: 50,\r\n    height: 50,\r\n    alignItems: 'center',\r\n  },\r\n\r\n  buttonContainer: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    justifyContent: 'flex-start',\r\n    alignItems: 'flex-start',\r\n  },\r\n\r\n  headerStyle: {\r\n    flex: 1,\r\n    flexDirection: 'column',\r\n    justifyContent: 'space-around',\r\n    alignItems: 'flex-start',\r\n  },\r\n\r\n  scrollView: {\r\n    flex: 1,\r\n    height: '100%',\r\n    width: '100%',\r\n    margin: 20,\r\n    alignSelf: 'center',\r\n  },\r\n});\r\n\r\nexport default HomeScreen;\r\n"]},"metadata":{},"sourceType":"module"}